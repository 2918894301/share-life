<!-- 发布页面 -->
<view class="publish-container">
  <!-- 顶部导航栏 -->
  <view class="nav-bar">
    <view class="nav-title">发布笔记</view>
  </view>
  <!-- 内容区域 -->
  <scroll-view scroll-y class="content-area">
    <!-- 媒体上传区域 -->
    <view class="media-upload">
      <view class="media-list">
        <!-- 图片列表 -->
        <view class="media-item" wx:for="{{images}}" wx:key="index">
          <image src="{{ item.tempFilePath}}" mode="aspectFill"></image>
          <view class="delete-btn" bindtap="deleteMedia" data-index="{{index}}" data-type="image">
            ×
          </view>
        </view>
        <!-- 视频列表 -->
        <view class="media-item" wx:for="{{videos}}" wx:key="index">
          <view class="video-preview-container">
            <image src="{{ item.tempFilePath}}" mode="aspectFill" class="video-thumbnail"></image>
            <view class="play-icon">▶</view>
            <view class="video-duration">{{Math.floor(item.duration)}}s</view>
          </view>
          <view class="delete-btn" bindtap="deleteMedia" data-index="{{index}}" data-type="video">
            ×
          </view>
        </view>
        <!-- 上传按钮 -->
        <view class="upload-btn" bindtap="chooseMedia" wx:if="{{(images.length < 5 && videos.length === 0) || (images.length === 0 && videos.length === 0)}}">
          <view class="plus">+</view>
          <view class="text">添加图片/视频</view>
        </view>
      </view>
    </view>
    <!-- 标题输入区域 -->
    <view class="title-area">
      <input placeholder="请输入笔记标题..." value="{{title}}" bindinput="onTitleInput" maxlength="20" class="title-input"></input>
      <view class="title-count">{{title.length}}/20</view>
    </view>
    <!-- 文本输入区域 -->
    <view class="text-area">
      <textarea placeholder="分享你的故事..." value="{{content}}" bindinput="onContentInput" maxlength="1000"></textarea>
      <view class="word-count">{{content.length}}/1000</view>
    </view>
    <!-- 分类选择 -->
    <view class="category-section">
      <view class="section-title">选择分类</view>
      <view class="category-list">
        <view class="category-item {{selectedCategory === item.id ? 'active' : ''}}" wx:for="{{categories}}" wx:key="id" bindtap="selectCategory" data-id="{{item.id}}">
          {{item.name}}
        </view>
      </view>
    </view>
    <!-- 位置信息 -->
    <view class="location-section" bindtap="chooseLocation">
      <view class="section-title">添加位置</view>
      <view class="location-info">
        <text>{{location ? location.name : '点击添加位置'}}</text>
        <view class="arrow">></view>
      </view>
    </view>
  </scroll-view>
  <!-- 底部按钮区域 -->
  <view class="bottom-bar">
    <view class="cancel-btn" bindtap="onCancel">取消</view>
    <view class="publish-btn {{canPublish ? 'active' : ''}}" bindtap="onPublish">发布</view>
  </view>
</view>